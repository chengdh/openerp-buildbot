<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <menuitem id="buildbot_menu" name="Buildbot" icon="terp-tools"/>
		<menuitem id="buildbot_config" name="Configuration" parent="buildbot_menu" sequence="3"/>
		<menuitem id="buildbot_test_detail" name="Test Detail" parent="buildbot_menu" sequence="1"/>

       <!-- Buildbot Groups -->

        <record id="view_buildbot_group_form" model="ir.ui.view">
        	<field name="name">Launchpad Teams</field>
            <field name="model">buildbot.lp.group</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form>
            		<field name="name"/>
            		<field name="sequence"/>
            		<field name="url" widget="url"/>
            	</form>
        	</field>
        </record>

        <record id="action_buildbot_group" model="ir.actions.act_window">
        	<field name="name">Launchpad Teams</field>
        	<field name="type">ir.actions.act_window</field>
            <field name="res_model">buildbot.lp.group</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
       	</record>

       	<menuitem id="buildbot_groups"  name="Launchpad Teams" parent="buildbot_config"
       	          sequence="5" action="action_buildbot_group"/>

        <!-- Buildbot Users -->

        <record id="view_buildbot_user_form" model="ir.ui.view">
        	<field name="name">Launchpad Users</field>
            <field name="model">buildbot.lp.user</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form>
            		<field name="name"/>
            		<field name="user_id"/>
            		<field name="url" colspan="2" widget="url"/>
            		<field name="lp_email" colspan="2" widget="url"/>
            		<separator string="Groups" colspan="4"/>
            		<field name="lp_group_ids" nolabel="1" colspan="4"/>
            	</form>
        	</field>
        </record>

        <record id="action_buildbot_user" model="ir.actions.act_window">
        	<field name="name">Launchpad Users</field>
        	<field name="type">ir.actions.act_window</field>
            <field name="res_model">buildbot.lp.user</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
       	</record>

       	<menuitem id="buildbot_users" name="Launchpad Users" parent="buildbot_config"
            sequence="5" action="action_buildbot_user"/>

       <!-- Buildbot Branches -->

        <record id="view_buildbot_branch_form" model="ir.ui.view">
        	<field name="name">Launchpad Branches</field>
            <field name="model">buildbot.lp.branch</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
	        	<form>
	                <field name="name"/>
					<field name="url" widget="url"/>
                   	<field name="lp_project_id" />
       				<field name="active"/>
					<field name="is_root_branch"/>
					<field name="is_test_branch"/>
       				<notebook colspan="4">
    					<page string="General Details">
        				 	<field name="lp_user_id"/>
		   					<field name="lp_group_id"/>
		   				</page>
    					<page string="Schedular">
   							<field name="treestabletimer"/>
       					</page>
       					<page string="Builder Settings">
							<field name="dbname"/>
							<field name="build_directory"/>
							<field name="port"/>
   							<field name="netport"/>
       					</page>
       					<page string="Merge Settings">
							<field name="merge_addons"/>
							<field name="merge_server"/>
							<field name="merge_extra_addons"/>
   							<field name="merge_community_addons"/>
       					</page>
       					<page string="Latest Revision Details" groups="base.group_extended">
   							<field name="latest_rev_no"/>
   							<field name="latest_rev_id"/>
						</page>
					</notebook>
            	</form>
        	</field>
        </record>

        <record id="action_buildbot_branch" model="ir.actions.act_window">
        	<field name="name">Launchpad Branches</field>
        	<field name="type">ir.actions.act_window</field>
            <field name="res_model">buildbot.lp.branch</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
       	</record>

       	<menuitem id="buildbot_branch" name="Launchpad Branches" parent="buildbot_config"
            	  sequence="5" action="action_buildbot_branch"/>

       <!-- Buildbot Tests -->
		<record id="view_test_order_filter" model="ir.ui.view">
			<field name="name">buildbot.test.list.select</field>
         	<field name="model">buildbot.test</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
            	<search string="Search Test Details">
                    <filter name="pass" string="Passed" domain="[('state','=','pass')]"/>
                    <filter  string="Failed" domain="[('state','=', 'fail')]"/>
                    <filter  string="Skipped" domain="[('state','=','skip')]"/>
                    <separator orientation="vertical"/>
                    <field name="name" select="1"/>
                    <field name="tested_branch" select="1"/>
                    <field name="test_date" select="1" string="Test Date" />
                    <newline/>
                    <group expand="1" string="Group By..." colspan="11" col="11">
                        <filter string="Branches"  domain="[]" context="{'group_by':'tested_branch'}"/>
                        <filter string="Test Date" domain="[]" context="{'group_by':'test_date'}"/>
                        <filter string="State" domain="[]" context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>

		<record id="view_buildbot_test_tree" model="ir.ui.view">
        	<field name="name">Test Details</field>
            <field name="model">buildbot.test</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
            	<tree>
            		<field name="test_date"/>
            		<field name="name"/>
            		<field name="tested_branch"/>
            		<field name="state"/>
            	</tree>
            </field>
        </record>
        <record id="view_buildbot_test_form" model="ir.ui.view">
        	<field name="name">Test Details</field>
            <field name="model">buildbot.test</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form>
            		<field name="test_date" colspan="2"/>
            		<field name="tested_branch" colspan="2"/>
            		<notebook colspan="4">
	            		<page string="Commit Details">
	            			<field name="commiter_id" colspan="2"/>
		            		<field name="commit_date" colspan="2"/>
		            		<field name="commit_rev_id" colspan="2"/>
		            		<field name="commit_rev_no" colspan="2"/>
		            		<field name="patch_attached" colspan="2"/>
		            		<label colspan="2" string=""/>
	            			<separator string="Commit Message" colspan="4"/>
                        	<field name="commit_comment"  nolabel="1" colspan="4"/>
                        	<group attrs="{'invisible':[('state','=','pass')]}" colspan="4">
                        		<separator string="Failure Reason"  colspan="4"/>
	            				<field name="failure_reason"  nolabel="1" colspan="4"/>
	            			</group>
						</page>
	            	<page string="File Status">
	            		<notebook colspan="4">
	            			<page string="New Files">
	            				<field name="new_files" nolabel="1"/>
	            			</page>
	            			<page string="Updated Files">
	            				<field name="update_files" nolabel="1"/>
	            			</page>
	            			<page string="Removed Files">
	            				<field name="remove_files" nolabel="1"/>
	            			</page>
	            			<page string="Renamed Files">
	            				<field name="rename_files" nolabel="1"/>
	            			</page>
	            		</notebook>
	            	</page>
	            	<page string="Test Steps">
            			<field name="test_step_ids" nolabel="1" colspan="4" />
            		</page>
            		<page string="Environment">
            			<field name="environment" nolabel="1" colspan="4"/>
            		</page>
            		</notebook>
					<field name="state"/>
            	</form>
        	</field>
        </record>

        <record id="action_buildbot_test" model="ir.actions.act_window">
        	<field name="name">Test Details</field>
        	<field name="type">ir.actions.act_window</field>
            <field name="res_model">buildbot.test</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{"search_default_pass":1}</field>
            <field name="search_view_id" ref="view_test_order_filter"/>
       	</record>

       	<menuitem id="buildbot_test" name="Test Details" parent="buildbot_test_detail"
                  sequence="5" action="action_buildbot_test"/>

        <!-- Buildbot Test Steps -->

		<record id="view_buildbot_test_step_tree" model="ir.ui.view">
        	<field name="name">Buildbot Test Step</field>
            <field name="model">buildbot.test.step</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
            	<tree string="Test Step">
            		<field name="name" colspan="2"/>
            		<field name="state" colspan="2"/>
            	</tree>
            </field>
        </record>

        <record id="view_buildbot_test_step_form" model="ir.ui.view">
        	<field name="name">Buildbot Test Step</field>
            <field name="model">buildbot.test.step</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form>
            		<field name="name" colspan="2"/>
            		<field name="test_id" colspan="2"/>
            		<notebook colspan="4">
            			<page string="Logs">
            				<notebook colspan="4">
			            		<page string="Error Log">
			            			<field name="error_log" colspan="2" nolabel="1"/>
			            		</page>
			            		<page string="Warning Log">
			            			<field name="warning_log" colspan="2" nolabel="1"/>
			            		</page>
			            		<page string="Critical Log">
			            			<field name="critical_log" colspan="2" nolabel="1"/>
			            		</page>
			            		<page string="Info Log">
			            			<field name="info_log" colspan="2" nolabel="1"/>
			            		</page>
			            		<page string="Yml Log">
			            			<field name="yml_log" colspan="2" nolabel="1"/>
			            		</page>
			            		<page string="Traceback">
			            			<field name="traceback_detail" nolabel="1" colspan="4"/>
			            		</page>
			            	</notebook>
			            </page>
            		</notebook>
            		<field name="state" colspan="2"/>
            	</form>
        	</field>
        </record>

	<!-- Buildbot Projects -->

        <record id="view_buildbot_project_form" model="ir.ui.view">
        	<field name="name">Launchpad Project</field>
            <field name="model">buildbot.lp.project</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
            	<form>
            		<field name="name" select="1"/>
            		<field name="url" select="1" widget="url"/>
            		<field name="tester_server_branch_id" domain="[('is_test_branch', '=', True)]"/>
            		<field name="tester_addons_branch_id" domain="[('is_test_branch', '=', True)]"/>
            		<field name="root_branch_id" domain="[('is_root_branch', '=', True)]"/>
            		<field name="branch_ids"  nolabel="1" colspan="4" domain="[('is_test_branch', '=', False), ('is_root_branch', '=', False)]">
            		   <tree string="Branches">
            		    	<field name="name"/>
            				<field name="url"/>
            				<field name="lp_user_id"/>
            				<field name="lp_group_id"/>
		            		<field name="lastest_rev_id"/>
		            		<field name="lastest_rev_no"/>
		            		<field name="active"/>
            			</tree>
            		    <form string="Branches">
            		    	<field name="name"/>
            				<field name="url"/>
            				<field name="lp_user_id"/>
            				<field name="lp_group_id"/>
		            		<field name="lastest_rev_id"/>
		            		<field name="lastest_rev_no"/>
		            		<field name="active"/>
            			</form>
            		</field>
            	</form>
        	</field>
        </record>

        <record id="action_buildbot_project" model="ir.actions.act_window">
        	<field name="name">Launchpad Projects</field>
        	<field name="type">ir.actions.act_window</field>
            <field name="res_model">buildbot.lp.project</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
       	</record>

       	<menuitem id="buildbot_project" name="Launchpad Projects" parent="buildbot_config"
                  sequence="5" action="action_buildbot_project"/>

    <act_window context="{'tested_branch': active_id}" domain="[('tested_branch', '=', active_id)]" id="act_test_branch" name="Test Results" res_model="buildbot.test" src_model="buildbot.lp.branch"/>

	</data>
</openerp>
